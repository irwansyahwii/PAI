// Generated by CoffeeScript 1.9.2
(function() {
  var ClickEffect, ScreenBase, ScreenGenericProjectDetail_1067x584, thumbScale,
    bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  ScreenBase = require("./ScreenBase_1067x584");

  ClickEffect = require("./ClickEffect");

  thumbScale = 0.4;

  ScreenGenericProjectDetail_1067x584 = (function(superClass) {
    extend(ScreenGenericProjectDetail_1067x584, superClass);

    function ScreenGenericProjectDetail_1067x584(options) {
      this.play = bind(this.play, this);
      this.onBackgroundLayerClicked = bind(this.onBackgroundLayerClicked, this);
      this.init = bind(this.init, this);
      this.hideAllLayers = bind(this.hideAllLayers, this);
      var i, j, thumbLayer;
      ScreenGenericProjectDetail_1067x584.__super__.constructor.apply(this, arguments);
      this.parent_screen = options.parent_screen || {};
      this.afterBackButtonClicked = null;
      if (this.parent_screen) {
        this.mainLayer.superLayer = this.parent_screen.mainLayer;
        this.mainLayer.placeBehind(this.parent_screen.topBarLayer);
      }
      this.mainLayer.backgroundColor = 'white';
      this.headerLayer = new Layer({
        image: 'images/ProjectDetail-Header.png',
        x: 0,
        y: this.parent_screen.topBarLayer.height - 1,
        width: this.width + 1,
        height: 40
      });
      this.headerLayer.superLayer = this.mainLayer;
      this.headerLayer.centerX();
      this.backButtonLayer = new Layer({
        image: 'images/ProfileMenu-Back.png',
        x: 19,
        y: 7,
        width: 45,
        height: 20
      });
      this.backButtonLayer.superLayer = this.headerLayer;
      this.backgroundLayer = new Layer({
        image: 'images/ProjectDetail-Full1.png',
        width: 1072,
        height: 710,
        y: -10
      });
      this.backgroundLayer.superLayer = this.mainLayer;
      this.backgroundLayer.placeBehind(this.headerLayer);
      this.backgroundLayer.on(Events.Click, this.onBackgroundLayerClicked);
      this.detailDescriptionLayer = new Layer({
        image: 'images/ProjectDetail-Detail1.png',
        width: 308,
        height: 359
      });
      this.detailDescriptionLayer.superLayer = this.mainLayer;
      this.thumbScroll = new ScrollComponent({
        backgroundColor: 'transparent',
        width: this.mainLayer.width,
        height: 154 * thumbScale,
        x: 0,
        y: this.mainLayer.height - (154 * thumbScale),
        scrollHorizontal: true
      });
      this.thumbScroll.superLayer = this.mainLayer;
      for (i = j = 1; j <= 12; i = ++j) {
        thumbLayer = new Layer({
          image: "images/MasterProjects-Thumb" + i + ".png",
          width: 266 * thumbScale,
          height: 154 * thumbScale,
          x: (i - 1) * (266 * thumbScale) + 2
        });
        thumbLayer.superLayer = this.thumbScroll;
      }
      this.isThumbScrollShown = true;
    }

    ScreenGenericProjectDetail_1067x584.prototype.hideAllLayers = function() {
      this.backgroundLayer.states["switch"]("fadeout");
      this.headerLayer.states["switch"]("top_outside");
      this.detailDescriptionLayer.states["switch"]("hidden");
      this.thumbScroll.states["switch"]("hidden");
      return this.parent_screen.disableStateSwitching = false;
    };

    ScreenGenericProjectDetail_1067x584.prototype.init = function() {
      ScreenGenericProjectDetail_1067x584.__super__.init.apply(this, arguments);
      this.headerLayer.states.add({
        top_outside: {
          y: -this.headerLayer.height
        },
        on_top: {
          y: this.parent_screen.topBarLayer.height - 1
        }
      });
      this.headerLayer.states.switchInstant("top_outside");
      ClickEffect.addTo(this.backButtonLayer);
      this.backButtonLayer.on(Events.Click, this.onBackButtonClicked);
      this.thumbScroll.states.add({
        hidden: {
          y: this.mainLayer.height + 2
        },
        shown: {
          y: this.mainLayer.height - (154 * thumbScale)
        }
      });
      this.backgroundLayer.states.add({
        fadein: {
          opacity: 1
        },
        fadeout: {
          opacity: 0
        }
      });
      this.backgroundLayer.states.switchInstant("fadeout");
      this.detailDescriptionLayer.states.add({
        hidden: {
          x: (this.mainLayer.width + this.detailDescriptionLayer.width) + 5,
          y: 130
        },
        shown: {
          x: this.mainLayer.width - this.detailDescriptionLayer.width,
          y: 130
        }
      });
      this.detailDescriptionLayer.states.switchInstant("hidden");
      return this.parent_screen.disableStateSwitching = true;
    };

    ScreenGenericProjectDetail_1067x584.prototype.onBackgroundLayerClicked = function() {
      if (this.isThumbScrollShown) {
        this.isThumbScrollShown = false;
        this.thumbScroll.states["switch"]("hidden");
        this.headerLayer.states["switch"]("top_outside");
        this.parent_screen.topBarLayer.states["switch"]("hidden");
        return this.detailDescriptionLayer.states["switch"]("hidden");
      } else {
        this.isThumbScrollShown = true;
        this.thumbScroll.states["switch"]("shown");
        this.headerLayer.states["switch"]("on_top");
        this.parent_screen.topBarLayer.states["switch"]("shown");
        return this.detailDescriptionLayer.states["switch"]("shown");
      }
    };

    ScreenGenericProjectDetail_1067x584.prototype.play = function() {
      this.show();
      this.headerLayer.states["switch"]("on_top");
      this.backgroundLayer.states["switch"]("fadein");
      return this.detailDescriptionLayer.states["switch"]("shown");
    };

    return ScreenGenericProjectDetail_1067x584;

  })(ScreenBase);

  module.exports = ScreenGenericProjectDetail_1067x584;

}).call(this);
